<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Streamly.Data.Fold</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Copyright   : (c) 2019 Composewell Technologies</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer  : streamly@composewell.com</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability : GHC</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- 'Fold' type represents an effectful action that consumes a value from an</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- input stream and combines it with a single final value often called an</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- accumulator, returning the resulting output accumulator.  Values from a</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- stream can be /pushed/ to the fold and consumed one at a time. It can also</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- be called a consumer of stream or a sink.  It is a data representation of</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- the standard 'Streamly.Prelude.foldl'' function.  A 'Fold' can be turned</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- into an effect (@m b@) using 'Streamly.Prelude.fold' by supplying it the</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- input stream.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Using this representation multiple folds can be combined efficiently using</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- combinators; a stream can then be supplied to the combined fold and it would</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- distribute the input to constituent folds according to the composition.  For</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- example, an applicative composition distributes the same input to the</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- constituent folds and then combines the resulting fold outputs.  Similarly,</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- a partitioning combinator divides the input among constituent folds.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- = Monoids</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- Monoids allow modular folding in general.  Most of the folds in this module</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- can be expressed using 'mconcat' and a suitable 'Monoid'. Instead of writing</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- folds we can write Monoids instead and turn them into folds.</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- = Performance Notes</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- 'Fold' representation is more efficient than using streams when splitting</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- streams.  @Fold m a b@ can be considered roughly equivalent to a fold action</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- @m b -&gt; t m a -&gt; m b@ (where @t@ is a stream type and @m@ is a 'Monad').</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Instead of using a 'Fold' type one could just use a fold action of the shape</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- @m b -&gt; t m a -&gt; m b@ for folding streams. However, multiple such actions</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- cannot be composed into a single fold function in an efficient manner.</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- Using the 'Fold' type we can efficiently split the stream across mutliple</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- folds because it allows the compiler to perform stream fusion optimizations.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- On the other hand, transformation operations (e.g. 'Streamly.Prelude.map')</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- on stream types can be as efficient as transformations on 'Fold' (e.g.</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- 'Streamly.Internal.Data.Fold.lmap').</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- = Left folds vs Right Folds</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- The folds in this module are left folds, therefore, even partial folds, e.g.</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- @head@ in this module, would drain the whole stream. On the other hand, the</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- partial folds in &quot;Streamly.Prelude&quot; module are lazy right folds and would</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- terminate as soon as the result is determined. However, the folds in this</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- module can be composed but the folds in &quot;Streamly.Prelude&quot; cannot be</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- composed.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- = Programmer Notes</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt; import qualified Streamly.Data.Fold as FL</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- More, not yet exposed, fold combinators can be found in</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- &quot;Streamly.Internal.Data.Fold&quot;.</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- IMPORTANT: keep the signatures consistent with the folds in Streamly.Prelude</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Streamly.Data.Fold</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Fold Type</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- |</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- A 'Fold' can be run over a stream using the 'Streamly.Prelude.fold'</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- combinator:</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; S.fold FL.sum (S.enumerateFromTo 1 100)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- 5050</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>      </span><span class="annot"><a href="Streamly.Internal.Data.Fold.Types.html#Fold"><span class="hs-identifier">Fold</span></a></span><span> </span><span class="hs-comment">-- (..)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- , tail</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- , init</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Full Folds</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#drain"><span class="hs-identifier">drain</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#drainBy"><span class="hs-identifier">drainBy</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#last"><span class="hs-identifier">last</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#length"><span class="hs-identifier">length</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#sum"><span class="hs-identifier">sum</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#product"><span class="hs-identifier">product</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#maximumBy"><span class="hs-identifier">maximumBy</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#maximum"><span class="hs-identifier">maximum</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#minimumBy"><span class="hs-identifier">minimumBy</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#minimum"><span class="hs-identifier">minimum</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- , the</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#mean"><span class="hs-identifier">mean</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#variance"><span class="hs-identifier">variance</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#stdDev"><span class="hs-identifier">stdDev</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Full Folds (Monoidal)</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#mconcat"><span class="hs-identifier">mconcat</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#foldMap"><span class="hs-identifier">foldMap</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#foldMapM"><span class="hs-identifier">foldMapM</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Full Folds (To Containers)</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- | Avoid using these folds in scalable or performance critical</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- applications, they buffer all the input in GC memory which can be</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- detrimental to performance if the input is large.</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#toList"><span class="hs-identifier">toList</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Partial Folds</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- , drainN</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- , drainWhile</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- , lastN</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- , (!!)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- , genericIndex</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#index"><span class="hs-identifier">index</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#head"><span class="hs-identifier">head</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- , findM</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#find"><span class="hs-identifier">find</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#lookup"><span class="hs-identifier">lookup</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#findIndex"><span class="hs-identifier">findIndex</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#elemIndex"><span class="hs-identifier">elemIndex</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#null"><span class="hs-identifier">null</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#elem"><span class="hs-identifier">elem</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#notElem"><span class="hs-identifier">notElem</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- XXX these are slower than right folds even when full input is used</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#all"><span class="hs-identifier">all</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#any"><span class="hs-identifier">any</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#and"><span class="hs-identifier">and</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#or"><span class="hs-identifier">or</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Transformations</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- | Unlike stream producer types (e.g. @SerialT m a@) which have only</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">-- output side, folds have an input side as well as an output side.  In the</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- type @Fold m a b@, the input type is @a@ and the output type is @b@.</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">-- Transformations can be applied either on the input side or on the output</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- side. The 'Functor' instance of a fold maps on the output of the fold:</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; S.fold (fmap show FL.sum) (S.enumerateFromTo 1 100)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- &quot;5050&quot;</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- However, the input side or contravariant transformations are more</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- interesting for folds.  The following sections describe the input</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- transformation operations on a fold.  The names of the operations are</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- consistent with their covariant counterparts in &quot;Streamly.Prelude&quot;, the</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- only difference is that they are prefixed with 'l' which stands for</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-comment">-- 'left' assuming left side is the input side, notice that in @Fold m a b@</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-comment">-- the type variable @a@ is on the left side.</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Covariant Operations</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#sequence"><span class="hs-identifier">sequence</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#mapM"><span class="hs-identifier">mapM</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">{-
    -- ** Mapping
    --, transform
    -- , lmap
    --, lsequence
    -- , lmapM

    -- -- ** Filtering
    -- , lfilter
    -- , lfilterM
    -- , ldeleteBy
    -- , luniq

    -- ** Mapping Filters
    , lmapMaybe
    , lmapMaybeM

    -- ** Scanning Filters
    , lfindIndices
    , lelemIndices

    -- ** Insertion
    -- | Insertion adds more elements to the stream.

    , linsertBy
    , lintersperseM

    -- ** Reordering
    , lreverse
    -}</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">{-
    -- * Parsing
    -- ** Trimming
    , ltake
    -- , lrunFor -- time
    , ltakeWhile
    , ltakeWhileM
    , ldrop
    , ldropWhile
    , ldropWhileM
    -}</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Distributing</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- |</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- The 'Applicative' instance of a distributing 'Fold' distributes one copy</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- of the stream to each fold and combines the results using a function.</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">--                 |-------Fold m a b--------|</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- ---stream m a---|                         |---m (b,c,...)</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">--                 |-------Fold m a c--------|</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">--                 |                         |</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">--                            ...</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- To compute the average of numbers in a stream without going through the</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- stream twice:</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; let avg = (/) &lt;$&gt; FL.sum &lt;*&gt; fmap fromIntegral FL.length</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; S.fold avg (S.enumerateFromTo 1.0 100.0)</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- 50.5</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- The 'Semigroup' and 'Monoid' instances of a distributing fold distribute</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- the input to both the folds and combines the outputs using Monoid or</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- Semigroup instances of the output types:</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Monoid (Sum)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; S.fold (FL.head &lt;&gt; FL.last) (fmap Sum $ S.enumerateFromTo 1.0 100.0)</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-comment">-- Just (Sum {getSum = 101.0})</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-comment">-- The 'Num', 'Floating', and 'Fractional' instances work in the same way.</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#tee"><span class="hs-identifier">tee</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#distribute"><span class="hs-identifier">distribute</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Partitioning</span></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- |</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- Direct items in the input stream to different folds using a binary</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- fold selector.</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-comment">-- , partitionByM</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-comment">-- , partitionBy</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#partition"><span class="hs-identifier">partition</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">{-
    -- * Demultiplexing
    -- | Direct values in the input stream to different folds using an n-ary
    -- fold selector.

    , demux
    -- , demuxWith
    , demux_
    -- , demuxWith_

    -- * Classifying
    -- | In an input stream of key value pairs fold values for different keys
    -- in individual output buckets using the given fold.

    , classify
    -- , classifyWith
    -}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Unzipping</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html#unzip"><span class="hs-identifier">unzip</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- These can be expressed using lmap/lmapM and unzip</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- , unzipWith</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- , unzipWithM</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- -- * Nested Folds</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- , concatMap</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- , chunksOf</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- , duplicate  -- experimental</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-269"></span><span>       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">dropWhile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">takeWhile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zipWith</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">,</span><span>
</span><span id="line-270"></span><span>               </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sequence</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">product</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>               </span><span class="annot"><span class="hs-identifier">notElem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maximum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">minimum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">last</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tail</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>               </span><span class="annot"><span class="hs-identifier">reverse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">iterate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">init</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">and</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">or</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(!!)</span></span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>               </span><span class="annot"><span class="hs-identifier">scanl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">scanl1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mconcat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unzip</span></span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>               </span><span class="annot"><span class="hs-identifier">span</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">splitAt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">break</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Streamly.Internal.Data.Fold.html"><span class="hs-identifier">Streamly.Internal.Data.Fold</span></a></span><span>
</span><span id="line-277"></span></pre></body></html>